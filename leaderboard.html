  <!DOCTYPE html>
  <html dir="rtl" lang="ar">
  <head>
      <meta charset="UTF-8">
      <meta name="viewport" content="width=device-width, initial-scale=1.0">
      <title>المتصدرين - فوازير رمضان 1446</title>
      <script src="https://cdn.tailwindcss.com"></script>
      <script src="https://unpkg.com/lucide@latest"></script>
      <script src="shared.js"></script>
      <style>
          @import url('https://fonts.googleapis.com/css2?family=Cairo:wght@400;600;700&display=swap');
          
          * {
              font-family: 'Cairo', sans-serif;
          }

          @keyframes floatMoon {
              0% { transform: translateY(0px); }
              50% { transform: translateY(-10px); }
              100% { transform: translateY(0px); }
          }

          .floating-moon {
              animation: floatMoon 3s ease-in-out infinite;
          }

          @keyframes twinkle {
              0%, 100% { opacity: 1; }
              50% { opacity: 0.3; }
          }

          .star {
              position: absolute;
              color: #FCD34D;
              animation: twinkle 2s ease-in-out infinite;
          }

          @keyframes floatCrown {
              0% { transform: translateY(0) rotate(0deg); }
              50% { transform: translateY(-5px) rotate(5deg); }
              100% { transform: translateY(0) rotate(0deg); }
          }

          .crown-animation {
              animation: floatCrown 2s ease-in-out infinite;
          }

          .trophy-gold {
              color: #FFD700;
              filter: drop-shadow(0 0 5px rgba(255, 215, 0, 0.5));
          }

          .trophy-silver {
              color: #C0C0C0;
              filter: drop-shadow(0 0 5px rgba(192, 192, 192, 0.5));
          }

          .trophy-bronze {
              color: #CD7F32;
              filter: drop-shadow(0 0 5px rgba(205, 127, 50, 0.5));
          }

          .animate-update {
              animation: update 0.5s ease-in-out;
          }

          @keyframes update {
              0% { opacity: 0.5; transform: scale(0.95); }
              100% { opacity: 1; transform: scale(1); }
          }

          .score-detail {
              font-size: 0.9rem;
              color: rgba(255, 255, 255, 0.7);
          }
      </style>
  </head>
  <body class="bg-gradient-to-b from-blue-900 to-indigo-950 min-h-screen">
      <!-- شريط التاريخ -->
      <div class="bg-white/5 backdrop-blur-sm border-b border-white/10 p-3 text-white text-center">
          <div class="max-w-3xl mx-auto flex justify-between items-center">
              <div class="flex items-center gap-2">
                  <i data-lucide="calendar" class="w-5 h-5 text-green-400"></i>
                  <span id="hijri-date" class="text-green-400">12 رمضان 1446هـ</span>
              </div>
              <div class="flex items-center gap-2">
                  <i data-lucide="calendar-days" class="w-5 h-5 text-yellow-400"></i>
                  <span id="gregorian-date" class="text-yellow-400">12/03/2025</span>
              </div>
          </div>
      </div>

      <div id="main-content" class="container mx-auto px-4 py-8">
          <div class="text-center mb-12">
              <div class="relative h-32 mb-6">
                  <div class="floating-moon">
                      <i data-lucide="moon" class="w-20 h-20 mx-auto text-yellow-400"></i>
                  </div>
                  <div class="absolute bottom-0 w-full">
                      <i data-lucide="star" class="star w-4 h-4" style="left: calc(50% - 20px);"></i>
                      <i data-lucide="star" class="star w-4 h-4" style="left: 50%;"></i>
                      <i data-lucide="star" class="star w-4 h-4" style="left: calc(50% + 20px);"></i>
                  </div>
              </div>
              <h1 class="text-3xl font-bold text-yellow-400 mb-4">🌙 المتصدرون في مسابقة اليوم</h1>
              <p class="text-white/80">أفضل المتسابقين في فوازير رمضان</p>
              <div class="text-sm text-green-400 mt-2">
                  <p>نظام النقاط:</p>
                  <p>إجابة صحيحة في أول ثانية: 1000 نقطة</p>
                  <p>إجابة صحيحة خلال 3 ثواني: 800 نقطة</p>
                  <p>إجابة صحيحة خلال 5 ثواني: 500 نقطة</p>
                  <p>إجابة صحيحة خلال 7 ثواني: 200 نقطة</p>
                  <p>إجابة صحيحة خلال 10 ثواني: 100 نقطة</p>
              </div>
          </div>

          <!-- قائمة المتصدرين -->
          <div class="max-w-3xl mx-auto space-y-4" id="leaderboard-container">
              <!-- المركز الأول -->
              <div class="bg-gradient-to-r from-yellow-500/20 to-yellow-600/5 backdrop-blur-lg rounded-xl p-6 border-2 border-yellow-400/30">
                  <div class="flex items-center justify-between">
                      <div class="flex items-center gap-4">
                          <div class="w-12 h-12 bg-yellow-400 rounded-full flex items-center justify-center text-yellow-900 text-2xl font-bold">1</div>
                          <div>
                              <h3 class="text-2xl font-bold text-white" id="first-place-name">-</h3>
                              <div class="text-yellow-400" id="first-place-score">- نقطة</div>
                              <div class="text-sm text-yellow-400/70" id="first-place-time">- ثانية</div>
                              <div class="score-detail" id="first-place-detail"></div>
                          </div>
                      </div>
                      <i data-lucide="crown" class="w-12 h-12 trophy-gold crown-animation"></i>
                  </div>
              </div>

              <!-- المركز الثاني -->
              <div class="bg-white/10 backdrop-blur-lg rounded-xl p-6 border-2 border-white/20">
                  <div class="flex items-center justify-between">
                      <div class="flex items-center gap-4">
                          <div class="w-10 h-10 bg-gray-300 rounded-full flex items-center justify-center text-gray-800 text-xl font-bold">2</div>
                          <div>
                              <h3 class="text-xl font-bold text-white" id="second-place-name">-</h3>
                              <div class="text-gray-300" id="second-place-score">- نقطة</div>
                              <div class="text-sm text-gray-400" id="second-place-time">- ثانية</div>
                              <div class="score-detail" id="second-place-detail"></div>
                          </div>
                      </div>
                      <i data-lucide="trophy" class="w-10 h-10 trophy-silver"></i>
                  </div>
              </div>

              <!-- المركز الثالث -->
              <div class="bg-white/10 backdrop-blur-lg rounded-xl p-6 border-2 border-orange-500/20">
                  <div class="flex items-center justify-between">
                      <div class="flex items-center gap-4">
                          <div class="w-10 h-10 bg-orange-400 rounded-full flex items-center justify-center text-orange-900 text-xl font-bold">3</div>
                          <div>
                              <h3 class="text-xl font-bold text-white" id="third-place-name">-</h3>
                              <div class="text-orange-400" id="third-place-score">- نقطة</div>
                              <div class="text-sm text-orange-400/70" id="third-place-time">- ثانية</div>
                              <div class="score-detail" id="third-place-detail"></div>
                          </div>
                      </div>
                      <i data-lucide="medal" class="w-10 h-10 trophy-bronze"></i>
                  </div>
              </div>
          </div>

          <!-- زر العودة -->
          <div class="text-center mt-8">
              <button
                  onclick="window.location.href='index.html'"
                  class="bg-gradient-to-r from-green-600 to-emerald-600 hover:from-green-700 hover:to-emerald-700 text-white px-8 py-3 rounded-xl text-lg inline-flex items-center gap-2"
              >
                  <i data-lucide="arrow-left" class="w-5 h-5"></i>
                  العودة للمسابقة
              </button>
          </div>
      </div>

      <script>
          // تهيئة أيقونات Lucide
          lucide.createIcons();

          // دالة لعرض رسالة عدم إتاحة المتصدرين
          function showAccessDeniedMessage(status) {
              document.getElementById('main-content').innerHTML = `
                  <div class="min-h-[calc(100vh-64px)] flex items-center justify-center">
                      <div class="text-center text-white p-8 bg-white/10 backdrop-blur-lg rounded-xl border-2 border-yellow-400/20 max-w-lg w-full">
                          <i data-lucide="clock" class="w-16 h-16 mx-auto text-yellow-400 mb-4"></i>
                          <h1 class="text-3xl font-bold text-yellow-400 mb-4">عذراً</h1>
                          <p class="mb-4 text-lg">${status.message}</p>
                          <p class="text-green-400 mb-6">${status.subMessage}</p>
                          <button
                              onclick="window.location.href='index.html'"
                              class="bg-gradient-to-r from-green-600 to-emerald-600 hover:from-green-700 hover:to-emerald-700 text-white px-8 py-3 rounded-xl text-lg inline-flex items-center gap-2"
                          >
                              <i data-lucide="arrow-left" class="w-5 h-5"></i>
                              العودة للمسابقة
                          </button>
                      </div>
                  </div>
              `;
              lucide.createIcons();
          }

          // دالة تحديث المتصدرين
          function updateLeaderboard() {
              const todayScores = getTodayScores();

              if (todayScores.length === 0) {
                  document.getElementById('leaderboard-container').innerHTML = `
                      <div class="bg-white/10 backdrop-blur-lg rounded-xl p-8 text-center">
                          <i data-lucide="info" class="w-16 h-16 mx-auto text-yellow-400 mb-4"></i>
                          <h3 class="text-2xl font-bold text-white mb-2">لا يوجد متسابقين بعد</h3>
                          <p class="text-gray-400">انتظر حتى نهاية المسابقة لرؤية النتائج</p>
                      </div>
                  `;
                  lucide.createIcons();
                  return;
              }

              const positions = ['first', 'second', 'third'];
              positions.forEach((pos, index) => {
                  const winner = todayScores[index] || { name: '-', points: '-', totalTime: '-', detailedAnswers: [] };
                  const nameElement = document.getElementById(`${pos}-place-name`);
                  const scoreElement = document.getElementById(`${pos}-place-score`);
                  const timeElement = document.getElementById(`${pos}-place-time`);
                  const detailElement = document.getElementById(`${pos}-place-detail`);

                  if (nameElement.textContent !== winner.name) {
                      nameElement.classList.add('animate-update');
                      setTimeout(() => nameElement.classList.remove('animate-update'), 500);
                  }

                  nameElement.textContent = winner.name;
                  scoreElement.textContent = winner.points === '-' ? '- نقطة' : 
                      `${winner.points} نقطة`;
                  timeElement.textContent = winner.totalTime === '-' ? '- ثانية' : 
                      `الوقت الكلي: ${winner.totalTime} ثانية`;

                  if (winner.detailedAnswers && winner.detailedAnswers.length > 0) {
                      const correctAnswers = winner.detailedAnswers.filter(a => a.isCorrect).length;
                      const fastAnswers = winner.detailedAnswers.filter(a => a.points >= 800).length;
                      detailElement.textContent = `إجابات صحيحة: ${correctAnswers} | إجابات سريعة: ${fastAnswers}`;
                  } else {
                      detailElement.textContent = '';
                  }
              });
          }

          // تهيئة الصفحة
          document.addEventListener('DOMContentLoaded', () => {
              if (!isLeaderboardTime()) {
                  const status = getQuizStatus();
                  showAccessDeniedMessage(status);
                  return;
              }
              
              updateLeaderboard();
              // تحديث كل 30 ثانية
              setInterval(updateLeaderboard, 30000);
          });
      </script>
  </body>
  </html>
